<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>We can help! í–‰ë™ ê³ ë¥´ê¸° ê²Œì„</title>
  <style>
    :root{
      --bg:#f6f8fa;
      --card:#ffffff;
      --ink:#111827;
      --muted:#6b7280;
      --line:#e5e7eb;
      --good:#16a34a;
      --bad:#ef4444;
      --shadow:0 10px 22px rgba(0,0,0,.07);
      --r:18px;
    }
    body{
      font-family:"Noto Sans KR", system-ui, sans-serif;
      background:var(--bg);
      padding:18px;
      color:var(--ink);
      max-width:920px;
      margin:0 auto;
    }
    h1{ text-align:center; margin:8px 0 6px; font-size:26px; }
    .sub{ text-align:center; margin:0 0 14px; color:var(--muted); line-height:1.35; }

    .panel{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--r);
      padding:12px 14px;
      box-shadow:var(--shadow);
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      margin-bottom:12px;
    }
    .pill{
      background:#111827;
      color:#fff;
      padding:8px 12px;
      border-radius:999px;
      font-weight:900;
      font-size:14px;
    }
    .btn{
      border:1px solid #d1d5db;
      background:#fff;
      border-radius:14px;
      padding:10px 12px;
      cursor:pointer;
      font-weight:900;
      font-size:14px;
    }
    .btn:hover{ background:#f3f4f6; }

    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--r);
      padding:16px;
      box-shadow:var(--shadow);
    }

    .bigFace{
      display:flex;
      justify-content:center;
      align-items:center;
      gap:14px;
      margin: 8px 0 10px;
      font-family:"Apple Color Emoji","Segoe UI Emoji","Noto Color Emoji",sans-serif;
    }
    #animalEmoji{ font-size: 92px; line-height:1; }
    #happyEmoji{ font-size: 78px; line-height:1; }

    #qTitle{
      text-align:center;
      font-size:22px;
      font-weight:1000;
      margin:0 0 8px;
    }
    #teacherLine{
      text-align:center;
      color:#374151;
      font-weight:900;
      background:#f9fafb;
      border:1px solid var(--line);
      border-radius:16px;
      padding:10px 12px;
      margin: 0 0 12px;
      line-height:1.4;
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap:12px;
      margin-top: 8px;
    }
    .choice{
      border:2px solid #d1d5db;
      border-radius:18px;
      padding:14px 10px;
      background:#fff;
      cursor:pointer;
      user-select:none;
      text-align:center;
      font-weight:1000;
      transition:.15s;
      box-shadow:0 6px 14px rgba(0,0,0,.05);
      font-size:18px;
      min-height: 70px;
      display:flex;
      align-items:center;
      justify-content:center;
      line-height:1.2;
    }
    .choice:hover{ background:#eef2ff; border-color:#a5b4fc; }
    .choice.correct{ border-color: var(--good); background:#f0fdf4; }
    .choice.wrong{ border-color: var(--bad); background:#fef2f2; }

    #explain{
      margin-top:12px;
      display:none;
      background:#ecfdf5;
      border:1px solid #bbf7d0;
      border-radius:16px;
      padding:12px;
      font-weight:1000;
      line-height:1.45;
      color:#064e3b;
      text-align:center;
    }

    .msg{
      min-height: 26px;
      margin-top: 10px;
      text-align:center;
      font-weight:1000;
      font-size:18px;
    }
    .ok{ color:var(--good); }
    .no{ color:var(--bad); }

    .row{
      display:flex;
      justify-content:center;
      gap:10px;
      flex-wrap:wrap;
      margin-top: 12px;
    }

    .backdrop{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.45);
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      z-index:50;
    }
    .modal{
      background:#fff;
      border-radius:18px;
      max-width:520px;
      width:100%;
      padding:18px;
      box-shadow:0 18px 40px rgba(0,0,0,.25);
      border:1px solid var(--line);
      text-align:center;
    }
    .modal h2{ margin:0 0 8px; font-size:24px; }
    .modal p{ margin:0 0 14px; color:#374151; font-weight:900; line-height:1.5; }
    .badge{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding:8px 10px;
      border-radius:999px;
      background:#f3f4f6;
      border:1px solid var(--line);
      font-weight:900;
      margin:4px;
    }

    @media (max-width: 720px){
      .grid{ grid-template-columns: 1fr; }
      #animalEmoji{ font-size: 86px; }
      #happyEmoji{ font-size: 72px; }
    }
  </style>
</head>

<body>
  <h1>ğŸŒ± We can help!</h1>
  <p class="sub">ë™ë¬¼ì´ ì›ƒì„ ìˆ˜ ìˆê²Œ, ìš°ë¦¬ê°€ í•  ìˆ˜ ìˆëŠ” í–‰ë™ì„ ê³¨ë¼ìš” ğŸ™‚</p>

  <div class="panel">
    <div class="pill">ë¬¸ì œ <span id="qNow">1</span> / <span id="qTotal">5</span></div>
    <div class="pill">ì ìˆ˜ <span id="scoreTxt">0</span>ì </div>
    <div>
      <button class="btn" id="sayBtn">ì„ ìƒë‹˜ ë©˜íŠ¸ ğŸ”Š</button>
      <button class="btn" id="resetBtn">ë‹¤ì‹œ í•˜ê¸°</button>
    </div>
  </div>

  <div class="card">
    <div class="bigFace">
      <span id="animalEmoji" aria-label="ë™ë¬¼">ğŸ¢</span>
      <span id="happyEmoji" aria-label="í–‰ë³µ">ğŸ˜Š</span>
    </div>

    <div id="qTitle">ì´ ë™ë¬¼ì„ ë„ì™€ì¤„ ìˆ˜ ìˆëŠ” í–‰ë™ì€ ë¬´ì—‡ì¼ê¹Œìš”?</div>
    <div id="teacherLine">â€œìš°ë¦¬ì˜ ì‘ì€ í–‰ë™ì´ ë™ë¬¼ì—ê²Œ í° ë„ì›€ì´ ë¼ìš”!â€</div>

    <div class="grid" id="choices"></div>

    <div class="msg" id="message"></div>
    <div id="explain"></div>

    <div class="row">
      <button class="btn" id="nextBtn" disabled>ë‹¤ìŒ â–¶</button>
    </div>
  </div>

  <div class="backdrop" id="backdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true">
      <h2>ğŸ‰ ë!</h2>
      <p id="resultText"></p>
      <div class="row">
        <button class="btn" id="againBtn" style="background:#111827;color:#fff;border-color:#111827;">í•œ ë²ˆ ë”</button>
        <button class="btn" id="closeBtn">ë‹«ê¸°</button>
      </div>
    </div>
  </div>

<script>
  // âœ… í–‰ë™ ê³ ë¥´ê¸°(ìœ ì•„ìš©): ì •ë‹µ 1ê°œ + ì˜¤ë‹µ 2ê°œ
  // ì˜¤ë‹µì€ "ë™ë¬¼ì„ ê´´ë¡­íˆê¸°"ì²˜ëŸ¼ í­ë ¥ì  í‘œí˜„ ëŒ€ì‹ , ìœ ì•„ìš©ìœ¼ë¡œ "ë™ë¬¼ì„ ê´´ë¡­í˜€ìš”" ì •ë„ë¡œ ì™„í™”.
  const QUESTIONS = [
    {
      animal: "ë°”ë‹¤ê±°ë¶", emoji: "ğŸ¢",
      correct: "í”Œë¼ìŠ¤í‹±ì„ ì¤„ì—¬ìš”.",
      wrongs: ["ë°”ë‹¤ì— ì“°ë ˆê¸°ë¥¼ ë²„ë ¤ìš”.", "ë™ë¬¼ì„ ê´´ë¡­í˜€ìš”."],
      explain: "ë°”ë‹¤ê±°ë¶ì€ í”Œë¼ìŠ¤í‹±ì„ ë¨¹ì´ë¡œ ì°©ê°í•  ìˆ˜ ìˆì–´ìš”. ì“°ë ˆê¸°ë¥¼ ì¤„ì´ë©´ ì•ˆì „í•´ì ¸ìš”!"
    },
    {
      animal: "í­ê·„", emoji: "ğŸ§",
      correct: "ì „ê¸°ë¥¼ ì•„ê»´ìš”.",
      wrongs: ["ë¶ˆì„ ì¼œ ë‘¬ìš”.", "ì–¼ìŒì„ ì¼ë¶€ëŸ¬ ë…¹ì—¬ìš”."],
      explain: "ì „ê¸°ë¥¼ ì•„ë¼ë©´ ì§€êµ¬ê°€ ëœ ë”ì›Œì ¸ìš”. ì–¼ìŒì´ ì§€ì¼œì§€ë©´ í­ê·„ë„ ì¢‹ì•„í•´ìš”!"
    },
    {
      animal: "íŒë‹¤", emoji: "ğŸ¼",
      correct: "ì¢…ì´ë¥¼ ì•„ê»´ ì¨ìš”.",
      wrongs: ["ì¢…ì´ë¥¼ ë§ì´ ë²„ë ¤ìš”.", "ë‚˜ë¬´ë¥¼ ë§ˆêµ¬ êº¾ì–´ìš”."],
      explain: "ì¢…ì´ë¥¼ ì•„ë¼ë©´ ë‚˜ë¬´ë¥¼ ì§€í‚¬ ìˆ˜ ìˆì–´ìš”. ìˆ²ì´ ì§€ì¼œì§€ë©´ íŒë‹¤ë„ ì‚´ê¸° ì¢‹ì•„ìš”!"
    },
    {
      animal: "í˜¸ë‘ì´", emoji: "ğŸ¯",
      correct: "ìì—°ì„ ê¹¨ë—í•˜ê²Œ ì§€ì¼œìš”.",
      wrongs: ["ìˆ²ì— ì“°ë ˆê¸°ë¥¼ ë²„ë ¤ìš”.", "ë‚˜ë¬´ë¥¼ í•¨ë¶€ë¡œ êº¾ì–´ìš”."],
      explain: "ìˆ²ì´ ê¹¨ë—í•˜ê³  ì•ˆì „í•´ì•¼ í˜¸ë‘ì´ê°€ ìˆ¨ê³  ì‚´ ìˆ˜ ìˆì–´ìš”."
    },
    {
      animal: "ì½”ë¼ë¦¬", emoji: "ğŸ˜",
      correct: "ë¬¼ê³¼ ì „ê¸°ë¥¼ ì•„ê»´ìš”.",
      wrongs: ["ë¬¼ì„ í‹€ì–´ë†“ê³  ë†€ì•„ìš”.", "ë¶ˆì„ ê³„ì† ì¼œë‘¬ìš”."],
      explain: "ìì›ì„ ì•„ë¼ë©´ ìì—°ì´ ëœ ë§ê°€ì ¸ìš”. ì½”ë¼ë¦¬ë„ ì‚´ ê³³ì„ ì§€í‚¬ ìˆ˜ ìˆì–´ìš”!"
    }
  ];

  let order = [];
  let idx = 0;
  let score = 0;
  let answered = false;

  const qNow = document.getElementById("qNow");
  const qTotal = document.getElementById("qTotal");
  const scoreTxt = document.getElementById("scoreTxt");
  const animalEmoji = document.getElementById("animalEmoji");
  const choicesDiv = document.getElementById("choices");
  const message = document.getElementById("message");
  const explainBox = document.getElementById("explain");
  const nextBtn = document.getElementById("nextBtn");

  const sayBtn = document.getElementById("sayBtn");
  const resetBtn = document.getElementById("resetBtn");

  const backdrop = document.getElementById("backdrop");
  const resultText = document.getElementById("resultText");
  const againBtn = document.getElementById("againBtn");
  const closeBtn = document.getElementById("closeBtn");

  function shuffle(arr){
    const a = [...arr];
    for(let i=a.length-1;i>0;i--){
      const j = Math.floor(Math.random()*(i+1));
      [a[i],a[j]] = [a[j],a[i]];
    }
    return a;
  }

  function toast(text, ok=null){
    message.textContent = text;
    message.className = "msg" + (ok===true ? " ok" : ok===false ? " no" : "");
  }

  function speak(text){
    try{
      const u = new SpeechSynthesisUtterance(text);
      u.lang = "ko-KR";
      u.rate = 0.95;
      speechSynthesis.cancel();
      speechSynthesis.speak(u);
    }catch(e){}
  }

  function buildOptions(q){
    return shuffle([q.correct, ...q.wrongs]);
  }

  function renderQuestion(){
    const q = order[idx];

    qNow.textContent = idx + 1;
    qTotal.textContent = order.length;

    animalEmoji.textContent = q.emoji;
    animalEmoji.setAttribute("aria-label", q.animal);

    const options = buildOptions(q);
    choicesDiv.innerHTML = "";
    options.forEach(text => {
      const btn = document.createElement("button");
      btn.type = "button";
      btn.className = "choice";
      btn.textContent = text;
      btn.addEventListener("click", () => choose(text, btn));
      choicesDiv.appendChild(btn);
    });

    answered = false;
    nextBtn.disabled = true;
    explainBox.style.display = "none";
    explainBox.textContent = "";
    toast("ì–´ë–¤ í–‰ë™ì´ ì¢‹ì„ê¹Œìš”? ğŸ™‚", null);
  }

  function choose(text, btn){
    if(answered) return;
    answered = true;

    const q = order[idx];
    const isCorrect = (text === q.correct);

    const all = Array.from(document.querySelectorAll(".choice"));
    all.forEach(b => b.style.pointerEvents = "none");

    if(isCorrect){
      score += 10;
      scoreTxt.textContent = score;
      btn.classList.add("correct");
      toast("âœ… ì¢‹ì•„ìš”! ì´ í–‰ë™ì´ ë™ë¬¼ì„ ë„ì™€ì¤˜ìš”!", true);
      speak("ì¢‹ì•„ìš”!");
    }else{
      btn.classList.add("wrong");
      toast("âŒ ì´ê±´ ë™ë¬¼ì„ ë„ì™€ì£¼ì§€ ëª»í•´ìš”. ì •ë‹µì„ ë³¼ê¹Œìš”?", false);
      speak("ì •ë‹µì„ ë³¼ê¹Œìš”?");
      const correctBtn = all.find(b => b.textContent === q.correct);
      if(correctBtn) correctBtn.classList.add("correct");
    }

    explainBox.textContent = "ì„¤ëª…: " + q.explain;
    explainBox.style.display = "block";
    nextBtn.disabled = false;
  }

  function next(){
    if(idx < order.length - 1){
      idx++;
      renderQuestion();
    }else{
      showResult();
    }
  }

  function showResult(){
    const correctCount = score / 10;
    resultText.innerHTML =
      `<span class="badge">âœ… ë§íŒ ê°œìˆ˜ ${correctCount} / ${order.length}</span>` +
      `<span class="badge">ğŸ† ì ìˆ˜ ${score}ì </span><br><br>` +
      `ìš°ë¦¬ì˜ í–‰ë™ì´ ë™ë¬¼ì„ ì§€ì¼œìš” ğŸŒğŸ’š<br>ì˜¤ëŠ˜ í•œ ê°€ì§€ ì•½ì†ì„ ì •í•´ë³¼ê¹Œìš”?`;
    backdrop.style.display = "flex";
    backdrop.setAttribute("aria-hidden","false");
  }

  function closeModal(){
    backdrop.style.display = "none";
    backdrop.setAttribute("aria-hidden","true");
  }

  function startGame(){
    closeModal();
    order = shuffle(QUESTIONS);
    idx = 0;
    score = 0;
    scoreTxt.textContent = score;
    renderQuestion();
  }

  nextBtn.addEventListener("click", next);

  sayBtn.addEventListener("click", () => {
    const q = order[idx];
    speak(`ì´ ë™ë¬¼ì„ ë„ì™€ì¤„ ìˆ˜ ìˆëŠ” í–‰ë™ì€ ë¬´ì—‡ì¼ê¹Œìš”? ${q.animal}ì´ì—ìš”. ì–´ë–¤ í–‰ë™ì´ ì¢‹ì„ê¹Œìš”?`);
  });

  resetBtn.addEventListener("click", startGame);
  againBtn.addEventListener("click", startGame);
  closeBtn.addEventListener("click", closeModal);
  backdrop.addEventListener("click", (e) => { if(e.target === backdrop) closeModal(); });

  window.addEventListener("keydown", (e) => {
    if(e.key === "Enter" && !nextBtn.disabled) next();
    if(e.key.toLowerCase() === "r") startGame();
    if(e.key === "Escape") closeModal();
  });

  startGame();
</script>
</body>
</html>
